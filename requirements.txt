# Smart Contract Vulnerability Detection - Training Requirements
# Optimized for RTX 4090 (24GB VRAM) single-GPU training

# =============================================================================
# Core ML Frameworks
# =============================================================================
torch>=2.1.0
transformers>=4.40.0
datasets>=2.18.0
accelerate>=0.27.0
safetensors>=0.4.0

# =============================================================================
# Training Libraries (as per PRD Section 4.2)
# =============================================================================

# Unsloth - 2x speed, 60% less memory (Primary for SFT)
# Install separately: pip install unsloth
unsloth[colab-new] @ git+https://github.com/unslothai/unsloth.git

# TRL - Transformer Reinforcement Learning (SFT, DPO, GRPO)
trl>=0.8.0

# PEFT - Parameter Efficient Fine-Tuning (LoRA)
peft>=0.10.0

# =============================================================================
# LLaMA-Factory (Unified training interface)
# Install separately if using: pip install llamafactory
# =============================================================================
# llamafactory  # Uncomment if preferred over Unsloth

# =============================================================================
# Evaluation & Metrics
# =============================================================================
evaluate>=0.4.0
scikit-learn>=1.3.0
seqeval>=1.2.2

# =============================================================================
# Data Processing
# =============================================================================
pandas>=2.0.0
pyarrow>=14.0.0
jsonlines>=4.0.0
tqdm>=4.66.0

# =============================================================================
# Experiment Tracking & Config
# =============================================================================
wandb>=0.16.0
pyyaml>=6.0
omegaconf>=2.3.0
hydra-core>=1.3.0

# =============================================================================
# Tokenizers & NLP
# =============================================================================
tokenizers>=0.15.0
sentencepiece>=0.1.99

# =============================================================================
# Memory Optimization for RTX 4090
# =============================================================================
bitsandbytes>=0.42.0  # 4-bit/8-bit quantization
flash-attn>=2.5.0     # Flash Attention 2 (requires CUDA 11.8+)

# =============================================================================
# Solidity-specific Tools (for validation)
# =============================================================================
# slither-analyzer  # Install separately: pip install slither-analyzer
# mythril           # Install separately: pip install mythril

# =============================================================================
# Utilities
# =============================================================================
python-dotenv>=1.0.0
rich>=13.0.0
typer>=0.9.0
click>=8.1.0
loguru>=0.7.0

# =============================================================================
# Jupyter (for experimentation)
# =============================================================================
jupyter>=1.0.0
ipywidgets>=8.0.0
matplotlib>=3.8.0
seaborn>=0.13.0
